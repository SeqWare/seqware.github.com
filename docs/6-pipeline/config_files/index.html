<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>SeqWare › Workflow Config Files</title>
<meta content="nanoc 3.6.5" name="generator">
<link href="../../../assets/style-v17.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://feeds.feedburner.com/seqware" rel="alternate" title="The SeqWare Blog" type="application/atom+xml">
<script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-34523087-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script>
<script type="text/javascript">         var disqus_shortname = 'seqware';          (function() {             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;             dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);         })();     </script>
</head>
<body>
<div class="wrapper">
<!-- ***** navigation ***** -->
<div class="nav">
<ol>
<li><a href="../../../"><span>Home</span></a></li>
<li><a href="../../../blog/"><span>News</span></a></li>
<li><a href="../../"><span>Documentation</span></a></li>
<li><a href="../../../community/"><span>Community</span></a></li>
<li><a href="../../../partners/"><span>Partners</span></a></li>
<li><a href="../../../about/"><span>About</span></a></li>
</ol>
</div>
<!-- ***** sidebar ***** -->
<div class="side">
<ol>
<li><a href="../../1-introduction/"><span>Introduction to SeqWare</span></a></li>
<li><a href="../../2-installation/"><span>Installation</span></a></li>
<li><a href="../../3-getting-started/"><span>Getting Started</span></a></li>
<li>
<a href="../"><span>SeqWare Pipeline</span></a><ol class="toc"><li><a href="#overview">Overview</a></li></ol>
</li>
<li><a href="../../4-metadb/"><span>SeqWare MetaDB</span></a></li>
<li><a href="../../5-portal/"><span>SeqWare Portal</span></a></li>
<li><a href="../../7-web-service/"><span>SeqWare Web Service</span></a></li>
<li><a href="../../8-query-engine/"><span>SeqWare Query Engine</span></a></li>
<li><a href="../../9-glossary/"><span>Glossary</span></a></li>
<li><a href="../../10-faq/"><span>Frequently Asked Questions</span></a></li>
<li><a href="../../11-api/"><span>APIs</span></a></li>
<li><a href="../../13-code/"><span>Source Code</span></a></li>
<li><a href="../../17-plugins/"><span>Plugins</span></a></li>
<li><a href="../../17a-modules/"><span>Modules</span></a></li>
</ol>
</div>
<!-- ***** body ***** -->
<div class="body">
<div class="article">
<div class="header">
<h1>Workflow Config Files</h1>
</div>
<div class="section" id="overview">
<h2>Overview</h2>

<p>Each workflow uses a simple INI file to record which variables it accepts,
their types, and default values.  For example:</p>

<pre><code class="language-ini"><span class="c1"># key=input_file:type=file:display=F:file_meta_type=text/plain</span>
<span class="na">input_file</span><span class="o">=</span><span class="s">${workflow_bundle_dir}/Workflow_Bundle_MyHelloWorld/${workflow-version}/data/input.txt</span>
<span class="c1"># key=greeting:type=text:display=T:display_name=Greeting</span>
<span class="na">greeting</span><span class="o">=</span><span class="s">Testing</span>

<span class="na">cat</span><span class="o">=</span><span class="s">${workflow_bundle_dir}/Workflow_Bundle_MyHelloWorld/${workflow-version}/bin/gnu-coreutils-5.67/cat</span>
<span class="na">echo</span><span class="o">=</span><span class="s">${workflow_bundle_dir}/Workflow_Bundle_MyHelloWorld/${workflow-version}/bin/gnu-coreutils-5.67/echo</span>

<span class="c1"># the output directory is a convention used in many workflows to specify a relative output path</span>
<span class="na">output_dir</span><span class="o">=</span><span class="s">seqware-results</span>
<span class="c1"># the output_prefix is a convention used to specify the root of the absolute output path or an S3 bucket name </span>
<span class="c1"># you should pick a path that is available on all cluster nodes and can be written by your user</span>
<span class="na">output_prefix</span><span class="o">=</span><span class="s">./</span>
<span class="c1"># manual output determines whether or not SeqWare should enforce the uniqueness of the final directory or not. </span>
<span class="c1"># If false, SeqWare places files in a directory specified by output_prefix/output_dir/workflowname_version/RANDOM/</span>
<span class="c1"># where RANDOM is an integer. If true, SeqWare places the files at output_prefix/output_dir and may overwrite existing</span>
<span class="c1"># files</span>
<span class="na">manual_output</span><span class="o">=</span><span class="s">false</span>


<span class="err">You</span> <span class="err">access</span> <span class="err">these</span> <span class="err">variables</span> <span class="err">in</span> <span class="err">the</span> <span class="err">Java</span> <span class="err">workflow</span> <span class="err">using</span> <span class="err">the</span>
<span class="err">getProperty()</span> <span class="err">method.</span> <span class="err">When</span> <span class="err">installing</span> <span class="err">the</span> <span class="err">workflow</span> <span class="err">the</span> <span class="err">ini</span> <span class="err">file</span> <span class="err">is</span>
<span class="err">parsed</span> <span class="err">and</span> <span class="err">extra</span> <span class="err">metadata</span> <span class="err">about</span> <span class="err">each</span> <span class="err">parameter</span> <span class="err">is</span> <span class="err">examined.</span> <span class="err">This</span> <span class="err">gives</span> <span class="err">the</span>
<span class="err">system</span> <span class="err">information</span> <span class="err">about</span> <span class="err">the</span> <span class="err">type</span> <span class="err">of</span> <span class="err">the</span> <span class="err">variable</span> <span class="err">(integer,</span> <span class="err">string,</span> <span class="err">etc)</span> <span class="err">and</span>
<span class="err">any</span> <span class="err">default</span> <span class="err">values.</span>

<span class="err">The</span> <span class="err">ini</span> <span class="err">file(s)</span> <span class="err">follow</span> <span class="err">the</span> <span class="err">general</span> <span class="err">pattern</span> <span class="err">of:</span>


<span class="c1"># comment/specification</span>
<span class="na">key</span><span class="o">=</span><span class="s">value</span>


<span class="err">To</span> <span class="err">achieve</span> <span class="err">this</span> <span class="err">overloaded</span> <span class="err">role</span> <span class="err">for</span> <span class="err">ini</span> <span class="err">files</span> <span class="err">you</span> <span class="err">need</span> <span class="err">to</span> <span class="err">include</span> <span class="err">hints</span> <span class="err">to</span>
<span class="err">ensure</span> <span class="err">the</span> <span class="err">BundleManager</span> <span class="err">that</span> <span class="err">installs</span> <span class="err">workflow</span> <span class="err">bundles</span> <span class="err">has</span> <span class="err">enough</span> <span class="err">information.</span>
<span class="err">Here</span> <span class="err">is</span> <span class="err">what</span> <span class="err">the</span> <span class="err">annotation</span> <span class="err">syntax</span> <span class="err">looks</span> <span class="err">like:</span>

    <span class="c1"># key=:type=[integer|float|text|pulldown|file]:display=[T|F][:display_name=][:file_meta_type=][:pulldown_items=|;|]</span>
    <span class="na">key</span><span class="o">=</span><span class="s">default_value</span>

<span class="na">The file_meta_type is only used for type</span><span class="o">=</span><span class="s">file.</span>

<span class="err">The</span> <span class="err">pulldown</span> <span class="err">type</span> <span class="err">means</span> <span class="err">that</span> <span class="err">the</span> <span class="err">pulldown_items</span> <span class="err">should</span> <span class="err">be</span> <span class="err">defined</span> <span class="err">as</span> <span class="err">well.</span> <span class="err">This</span> <span class="err">looks</span> <span class="err">like:</span>

    <span class="na">pulldown_items</span><span class="o">=</span><span class="s">|;|</span>

<span class="err">The</span> <span class="err">default</span> <span class="err">value</span> <span class="err">for</span> <span class="err">this</span> <span class="err">will</span> <span class="err">refer</span> <span class="err">to</span> <span class="err">either</span> <span class="err">value1</span> <span class="err">or</span> <span class="err">value2</span> <span class="err">above.</span>
<span class="err">If</span> <span class="err">you</span> <span class="err">fail</span> <span class="err">to</span> <span class="err">include</span> <span class="err">a</span> <span class="err">metadata</span> <span class="err">line</span> <span class="err">for</span> <span class="err">a</span> <span class="err">particular</span> <span class="err">key/value</span> <span class="err">then</span> <span class="err">it</span> <span class="err">is</span> <span class="err">assumed</span> <span class="err">to</span> <span class="err">be:</span>

    <span class="na">key</span><span class="o">=</span><span class="s">:type=text:display=F</span>

<span class="err">This</span> <span class="err">is</span> <span class="err">convenient</span> <span class="err">since</span> <span class="err">many</span> <span class="err">of</span> <span class="err">the</span> <span class="err">values</span> <span class="err">in</span> <span class="err">an</span> <span class="err">INI</span> <span class="err">file</span> <span class="err">should</span> <span class="err">not</span> <span class="err">be</span> <span class="err">displayed</span> <span class="err">to</span> <span class="err">the</span> <span class="err">end</span> <span class="err">user.</span>

<span class="c1">### Required INI Entries</span>

<span class="err">There</span> <span class="err">are</span> <span class="err">(currently)</span> <span class="err">two</span> <span class="err">required</span> <span class="err">entries</span> <span class="err">that</span> <span class="err">all</span> <span class="err">workflows</span> <span class="err">should</span> <span class="err">define</span>
<span class="err">in</span> <span class="err">their</span> <span class="err">ini</span> <span class="err">files.</span> <span class="err">These</span> <span class="err">are</span> <span class="err">related</span> <span class="err">to</span> <span class="err">output</span> <span class="err">file</span> <span class="err">provisioning.</span> <span class="err">In</span> <span class="err">your</span> <span class="err">workflow,</span>
<span class="err">if</span> <span class="err">you</span> <span class="err">produce</span> <span class="err">output</span> <span class="err">files</span> <span class="err">and</span> <span class="err">use</span> <span class="err">the</span> <span class="err">file</span> <span class="err">provisioning</span> <span class="err">mechanism</span> <span class="err">built</span> <span class="err">into</span>
<span class="err">workflows</span> <span class="err">these</span> <span class="err">two</span> <span class="err">entries</span> <span class="err">are</span> <span class="err">used</span> <span class="err">to</span> <span class="err">construct</span> <span class="err">the</span> <span class="err">output</span> <span class="err">location</span> <span class="err">for</span> <span class="err">the</span>
<span class="err">output</span> <span class="err">file.</span>

<span class="err">*</span> <span class="err">output_dir</span>
<span class="err">*</span> <span class="err">output_prefix</span>

<span class="err">For</span> <span class="err">example,</span> <span class="err">if</span> <span class="err">you</span> <span class="err">have</span> <span class="err">a</span> <span class="err">SqwFile</span> <span class="err">object</span> <span class="err">can</span> <span class="err">call</span>
<span class="err">file.setIsOutput(true)</span><span class="c1">; the workflow engine constructs an output path</span>
<span class="err">for</span> <span class="err">this</span> <span class="err">file</span> <span class="err">using</span> <span class="err">the</span> <span class="err">following:</span>

	<span class="err">//</span>

<span class="err">You</span> <span class="err">can</span> <span class="err">use</span> <span class="err">s3://bucketname/</span> <span class="err">or</span> <span class="err">a</span> <span class="err">local</span> <span class="err">path</span> <span class="err">as</span> <span class="err">the</span> <span class="err">prefix.</span>


<span class="err">Note:</span> <span class="err">While</span> <span class="err">the</span> <span class="err">above</span> <span class="err">entries</span> <span class="err">are</span> <span class="err">required,</span> <span class="err">it</span> <span class="err">is</span> <span class="err">STRONGLY</span> <span class="err">suggested</span> <span class="err">that</span> <span class="err">workflow</span> <span class="err">developers</span> <span class="err">no</span> <span class="err">longer</span> <span class="err">rely</span> <span class="err">on</span> <span class="err">them</span> <span class="err">to</span> <span class="err">decide</span> <span class="err">the</span> <span class="err">output</span> <span class="err">path</span> <span class="err">of</span> <span class="err">a</span> <span class="err">provisioned</span> <span class="err">file.</span>  <span class="err">Instead</span> <span class="err">we</span> <span class="err">recommend</span> <span class="err">explicitly</span> <span class="err">providing</span> <span class="err">in</span> <span class="err">the</span> <span class="err">ini</span> <span class="err">file</span> <span class="err">whatever</span> <span class="err">paths</span> <span class="err">you</span> <span class="err">may</span> <span class="err">require,</span> <span class="err">possibly</span> <span class="err">using</span> <span class="err">the</span> <span class="err">variables</span> <span class="err">described</span> <span class="err">below,</span> <span class="err">and</span> <span class="err">then</span> <span class="err">assigning</span> <span class="err">that</span> <span class="err">path</span> <span class="err">to</span> <span class="err">the</span> <span class="err">output</span> <span class="err">file</span> <span class="err">via</span> <span class="err">SqwFile.setOutputPath(String</span> <span class="err">path).</span>


<span class="c1">### INI Variables</span>

<span class="err">The</span> <span class="err">ini</span> <span class="err">files</span> <span class="err">support</span> <span class="err">variables,</span> <span class="err">in</span> <span class="err">the</span> <span class="err">format</span> <span class="err">`$(variable-name}`,</span> <span class="err">that</span> <span class="err">will</span> <span class="err">be</span> <span class="err">replaced</span> <span class="err">when</span> <span class="err">the</span> <span class="err">workflow</span> <span class="err">run</span> <span class="err">is</span> <span class="err">launched.</span> <span class="err">The</span> <span class="err">variable</span> <span class="err">name</span> <span class="err">can</span> <span class="err">refer</span> <span class="err">to</span> <span class="err">another</span> <span class="err">entry</span> <span class="err">in</span> <span class="err">the</span> <span class="err">ini</span> <span class="err">file,</span> <span class="err">or</span> <span class="err">can</span> <span class="err">refer</span> <span class="err">to</span> <span class="err">the</span> <span class="err">following</span> <span class="err">SeqWare</span> <span class="err">generated</span> <span class="err">values:</span>

<span class="err">*</span> <span class="err">`sqw.bundle-dir`:</span> <span class="err">the</span> <span class="err">path</span> <span class="err">to</span> <span class="err">the</span> <span class="err">directory</span> <span class="err">of</span> <span class="err">this</span> <span class="err">workflow's</span> <span class="err">bundle.</span> <span class="err">Support</span> <span class="err">for</span> <span class="err">the</span> <span class="err">legacy</span> <span class="err">version</span> <span class="err">of</span> <span class="err">this</span> <span class="err">variable,</span> <span class="err">`workflow_bundle_dir`,</span> <span class="err">may</span> <span class="err">be</span> <span class="err">removed</span> <span class="err">in</span> <span class="err">a</span> <span class="err">future</span> <span class="err">version.</span>
<span class="err">*</span> <span class="err">`sqw.date`:</span> <span class="err">the</span> <span class="err">current</span> <span class="err">date</span> <span class="err">in</span> <span class="err">ISO</span> <span class="err">8601</span> <span class="err">format,</span> <span class="err">e.g.,</span> <span class="err">2013-10-31.</span>  <span class="err">Support</span> <span class="err">for</span> <span class="err">the</span> <span class="err">legacy</span> <span class="err">version</span> <span class="err">of</span> <span class="err">this</span> <span class="err">variable,</span> <span class="err">`date`,</span> <span class="err">may</span> <span class="err">be</span> <span class="err">removed</span> <span class="err">in</span> <span class="err">a</span> <span class="err">future</span> <span class="err">version.</span>
<span class="err">*</span> <span class="err">`sqw.datetime`:</span> <span class="err">the</span> <span class="err">current</span> <span class="err">datetime</span> <span class="err">in</span> <span class="err">ISO</span> <span class="err">8601</span> <span class="err">format,</span> <span class="err">e.g.,</span> <span class="err">2013-10-31T16:45:30.</span>
<span class="err">*</span> <span class="err">`sqw.random`:</span> <span class="err">a</span> <span class="err">randomly</span> <span class="err">generated</span> <span class="err">integer</span> <span class="err">from</span> <span class="err">0</span> <span class="err">to</span> <span class="err">2147483647.</span>  <span class="err">Support</span> <span class="err">for</span> <span class="err">the</span> <span class="err">legacy</span> <span class="err">version</span> <span class="err">of</span> <span class="err">this</span> <span class="err">variable,</span> <span class="err">`random`,</span> <span class="err">may</span> <span class="err">be</span> <span class="err">removed</span> <span class="err">in</span> <span class="err">a</span> <span class="err">future</span> <span class="err">version.</span>
<span class="err">*</span> <span class="err">`sqw.timestamp`:</span> <span class="err">the</span> <span class="err">current</span> <span class="err">number</span> <span class="err">of</span> <span class="err">milliseconds</span> <span class="err">since</span> <span class="err">January</span> <span class="err">1,</span> <span class="err">1970.</span>
<span class="err">*</span> <span class="err">`sqw.uuid`:</span> <span class="err">a</span> <span class="err">randomly</span> <span class="err">generated</span> <span class="err">universally</span> <span class="err">unique</span> <span class="err">identifier.</span>

<span class="err">Each</span> <span class="err">instance</span> <span class="err">of</span> <span class="err">the</span> <span class="err">above</span> <span class="err">`sqw.*`</span> <span class="err">variables</span> <span class="err">in</span> <span class="err">an</span> <span class="err">ini</span> <span class="err">file</span> <span class="err">will</span> <span class="err">be</span> <span class="err">replaced</span> <span class="err">with</span> <span class="err">a</span> <span class="err">separately</span> <span class="err">resolved</span> <span class="err">value,</span> <span class="err">e.g.,</span> <span class="err">multiple</span> <span class="err">instances</span> <span class="err">of</span> <span class="err">`${sqw.uuid}`</span> <span class="err">will</span> <span class="err">each</span> <span class="err">resolve</span> <span class="err">to</span> <span class="err">different</span> <span class="err">values.</span> <span class="err">If</span> <span class="err">you</span> <span class="err">desire</span> <span class="err">to</span> <span class="err">reuse</span> <span class="err">the</span> <span class="err">same</span> <span class="err">generated</span> <span class="err">value,</span> <span class="err">do</span> <span class="err">somthing</span> <span class="err">akin</span> <span class="err">to</span> <span class="err">the</span> <span class="err">following:</span>

<span class="c1">#!ini</span>
<span class="na">dirname</span><span class="o">=</span><span class="s">output</span>
<span class="na">filename</span><span class="o">=</span><span class="s">${sqw.random}</span>
<span class="na">text_file</span><span class="o">=</span><span class="s">${dirname}/${filename}.txt</span>
<span class="na">json_file</span><span class="o">=</span><span class="s">${dirname}/${filename}.json</span>


<span class="err">Thus</span> <span class="err">if</span> <span class="err">`filename`</span> <span class="err">resolved</span> <span class="err">to</span> <span class="err">a</span> <span class="err">value</span> <span class="err">of</span> <span class="err">`12345`,</span> <span class="err">then</span> <span class="err">`text_file`</span> <span class="err">will</span> <span class="err">have</span> <span class="err">a</span> <span class="err">value</span> <span class="err">of</span> <span class="err">`output/12345.txt`</span> <span class="err">and</span> <span class="err">`json_file`</span> <span class="err">will</span> <span class="err">have</span> <span class="err">a</span> <span class="err">value</span> <span class="err">of</span> <span class="err">`output/12345.json`.</span></code></pre>
</div>
</div>
<p> </p>
<p> </p>
<div id="disqus_thread"></div>
</div>
</div>
<!-- ***** footer ***** -->
<div id="footer">
<p>SeqWare © 2007–2013 Brian O&#8217;Connor. SeqWare is released under the a <a rel="license" href="http://www.gnu.org/licenses/licenses.html">GNU GPL v3</a>. This site is built using the excellent <a href="http://nanoc.ws/">nanoc</a> tool and example site along with the <a href="http://www.fonts.info/info/press/free-fonts-for-font-face-embedding.htm">Graublau</a> and <a href="https://en.wikipedia.org/wiki/Gentium">Gentium</a> fonts.</p>
</div>
</body>
</html>