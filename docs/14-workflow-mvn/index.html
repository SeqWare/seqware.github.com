<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>SeqWare › Creating New Workflow Bundles and Modules Using Maven Archetypes</title>
<meta content="nanoc 3.4.0" name="generator">
<link href="../../assets/style-v17.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://feeds.feedburner.com/seqware" rel="alternate" title="The SeqWare Blog" type="application/atom+xml">
<script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-34523087-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script>
</head>
<body>
<div class="wrapper">
<!-- ***** navigation ***** -->
<div class="nav">
<ol>
<li><a href="../../"><span>Home</span></a></li>
<li><a href="../../blog/"><span>News</span></a></li>
<li><a href="../"><span>Documentation</span></a></li>
<li><a href="../../community/"><span>Community</span></a></li>
<li><a href="../../partners/"><span>Partners</span></a></li>
<li><a href="../../about/"><span>About</span></a></li>
</ol>
</div>
<!-- ***** sidebar ***** -->
<div class="side">
<ol>
<li><a href="../1-introduction/"><span>Introduction to SeqWare</span></a></li>
<li><a href="../2-installation/"><span>Installation</span></a></li>
<li><a href="../3-getting-started/"><span>Getting Started</span></a></li>
<li><a href="../4-metadb/"><span>SeqWare MetaDB</span></a></li>
<li><a href="../5-portal/"><span>SeqWare Portal</span></a></li>
<li><a href="../6-pipeline/"><span>SeqWare Pipeline</span></a></li>
<li><a href="../7-web-service/"><span>SeqWare Web Service</span></a></li>
<li><a href="../8-query-engine/"><span>SeqWare Query Engine</span></a></li>
<li><a href="../9-glossary/"><span>Glossary</span></a></li>
<li><a href="../10-faq/"><span>Frequently Asked Questions</span></a></li>
<li><a href="../11-api/"><span>APIs</span></a></li>
<li><a href="../13-code/"><span>Source Code</span></a></li>
</ol>
</div>
<!-- ***** body ***** -->
<div class="body">
<div class="article">
<div class="header">
<h1>Creating New Workflow Bundles and Modules Using Maven Archetypes</h1>
</div>
<p>The SeqWare workflow archetype and module archetype allow workflow developers to quickly create workflows and modules. The Maven archetypes generate skeletons (of workflows or module) that contain a simple example program that can be modified to create a new workflow or module. The archetypes also take parameters prior to skeleton generation that allow the name of the workflow or module to be specified and all configuration files to adjusted with respect to these parameters.</p>

<p>The code generated by the archetype contains all the necessary files to generate a complete workflow bundle or module when the mvn install command is issued. This command will combine the .ini file and the user created Java file with other external dependencies pulled in by Maven to create a complete workflow bundle or module. This makes the code  generated by the archetype ideal to place under version control. As maintenance changes are made to the Java file or any other aspect of the workflow, these files can be updated and a new workflow reflecting these changes can be generated by re-issuing the  <tt>mvn install</tt> command.</p>

<div class="section" id="installation">
<h2>Installation</h2>

<p>The Maven archetypes are part of SeqWare and are automatically installed when the SeqWare source is checked out and compiled with the <tt>mvn install</tt> command.</p>

<pre><code>$ svn co https://seqware.svn.sourceforge.net/svnroot/seqware/trunk seqware-trunk
$ cd seqware-trunk
$ mvn install
</code></pre>

<p>If you got problems of testing error. You can skip the test by</p>

<pre><code>$ mvn install -Dmaven.test.skip=true
</code></pre>

</div>
<div class="section" id="usage">
<h2>Usage</h2>

<p>Change to the parent directory for the workflow code you are about the create.</p>

<pre><code>$ cd /u/home/user/code
</code></pre>

<p>Run the command to create a new workflow or module skeleton. The new code will be placed in a child directory.</p>

<pre><code>$ mvn archetype:generate

...
660: local -&gt; com.github.seqware:seqware-archetype-workflow (SeqWare workflow archetype)
661: local -&gt; com.github.seqware:seqware-archetype-java-workflow (SeqWare Java workflow archetype)
662: local -&gt; com.github.seqware:seqware-archetype-ftl-workflow (SeqWare FTL workflow archetype)
Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 205:
</code></pre>

<p>The numbers used to identify  the archetypes (660,661,662) will vary, so you will need to scan through the list to find the SeqWare archetype you&#8217;re looking for.</p>

<p>661: if you want to write your workflow using Java objects.</p>

<p>662: if you want to write your workflow using FTL.</p>

<p><b>SeqWare WorkflowV2 Archetype</b></p>

<pre><code>$ mvn archetype:generate
...
660: local -&gt; com.github.seqware:seqware-archetype-workflow (SeqWare workflow archetype)
661: local -&gt; com.github.seqware:seqware-archetype-java-workflow (SeqWare Java workflow archetype)
662: local -&gt; com.github.seqware:seqware-archetype-ftl-workflow (SeqWare FTL workflow archetype)
Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 205: 661
Define value for property 'groupId': : net.sf.seqware
Define value for property 'artifactId': : workflow-helloworld-example
Define value for property 'version': 1.0-SNAPSHOT: 1.0
Define value for property 'package': net.sf.seqware:
Define value for property 'workflowDirectoryName': : helloworld_example
Define value for property 'workflowName': : HelloWorldExample
Confirm properties configuration:
groupId: net.sf.seqware
artifactId: workflow-helloworld-example
version: 1.0
package: net.sf.seqware
workflowDirectoryName: helloworld_example
workflowName: HelloWorldExample
</code></pre>

<ul>
<li>groupId
: The workflow belongs to this group. This group id is part of the workflow&#8217;s unique identity.</li>
<li>artifactId
: The specific name of the workflow. Also part of the workflow&#8217;s unique identity. This will also be used as the name of the directory containing all the files associated with this workflow.</li>
<li>version
: The version of this workflow. Again, part of the workflow&#8217;s unique identity. When maintaining the code in the future it will be possible to update this value.</li>
<li>package
: This is a java package name. In the context of creating a workflow this is not used. Just press enter.</li>
<li>workflowDirectoryName
: A unique workflow directory name. No spaces. All lowercase, separated by underscores.</li>
<li>
<p>workflowName
: A unique camel case workflow name.</p>

<p>  $ cd workflow-helloworld-example</p>

<p>  $ ls</p>

<p>  pom.xml  workflow  workflow.properties</p>
</li>
<li><p>pom.xml
: A maven project file. Edit this to change the version of the workflow and to add or modify workflow dependencies such as program, modules and data.</p></li>
<li>workflow
: This directory contains the workflow skeleton. Look in here to modify the workflow .ini, .java files (Java workflow) or workflow.ftl(FTL workflow). The examples of Java and FTL can be found <a href="../15-workflow-examples/">here</a>.</li>
<li>workflow.properties
: Edit the description and workflow names in this file.</li>
</ul>
</div>
<div class="section" id="variables">
<h2>Variables</h2>

<p>Automatically Defined
* ${date}: a string representing the date the DAX was created, this is always defined so consider this a reserved variable name.</p>

<ul>
<li><p>${random}: a randomly generated string, this is always defined so consider this a reserved variable name.</p></li>
<li><p>${workflow_bundle_dir}: if this workflow is part of a workflow bundle this variable will be defined and points to the path of the root of the directory this workflow bundle has been expanded to.</p></li>
<li><p>${workflow_base_dir}: ${workflow_bundle_dir}/Workflow_Bundle_{workflow_name}/{workflow_version}</p></li>
</ul>
</div>
<div class="section" id="building-the-workflow">
<h2>Building the Workflow</h2>

<p>The archetype is just a template for the workflow bundle.  You need to use &#8220;mvn install&#8221; to actually build the workflow bundle.</p>

<pre><code>$ mvn install
[INFO] Scanning for projects...
[INFO]  ------------------------------------------------------------------------
[INFO] Building seqware-workflow
...
[INFO]  -----------------------------------------------------   -------------------
[INFO] BUILD SUCCESSFUL
[INFO]  ------------------------------------------------------------------------
[INFO] Total time: 22 seconds
[INFO] Finished at: Wed Feb 22 15:22:05 EST 2012
[INFO] Final Memory: 46M/448M
[INFO]  ------------------------------------------------------------------------
</code></pre>

</div>
<div class="section" id="testing-the-workflow">
<h2>Testing the Workflow</h2>

<pre><code>java -jar target/Workflow_Bundle_vep_1.0_SeqWare_0.12.5-SNAPSHOT/Workflow_Bundle_vep/1.0/lib/seqware-distribution-0.12.5-SNAPSHOT-full.jar --plugin net.sourceforge.seqware.pipeline.plugins.WorkflowLauncherV2 --  --provisioned-bundle-dir target/Workflow_Bundle_vep_1.0_SeqWare_0.12.5-SNAPSHOT/ --workflow vep --version 1.0 --ini-files target/Workflow_Bundle_vep_1.0_SeqWare_0.12.5-SNAPSHOT/Workflow_Bundle_vep/1.0/config/workflow.ini --wait
</code></pre>

<p>output:</p>

<pre><code>SUBMITTING TO PEGASUS: pegasus-plan -Dpegasus.user.properties=/u/seqwaretest/.seqware/pegasus/properties --dax /tmp/dax63588764095847722002087051279420911 --dir /u/seqwaretest/seqware-development/pegasus-dax -o sqwstage.hpc.oicr.on.ca --force --submit -s sqwstage.hpc.oicr.on.ca
PEGASUS STATUS COMMAND: pegasus-status -l /u/seqwaretest/seqware-development/pegasus-dax/seqwaretest/pegasus/vep/run0043
MONITORING PEGASUS STATUS:
RUNNING: step 1 of 33 (3%)
RUNNING: step 2 of 33 (6%)
RUNNING: step 3 of 33 (9%)
RUNNING: step 8 of 33 (24%)
RUNNING: step 18 of 33 (54%)
RUNNING: step 26 of 33 (78%)
RUNNING: step 29 of 33 (87%)
RUNNING: step 30 of 33 (90%)
RUNNING: step 31 of 33 (93%)
RUNNING: step 32 of 33 (96%)
WORKFLOW COMPLETED SUCCESSFULLY!
</code></pre>
</div>
</div>
</div>
</div>
<!-- ***** footer ***** -->
<div id="footer">
<p>SeqWare © 2007–2012 Brian O&#8217;Connor. SeqWare is released under the a <a rel="license" href="http://www.gnu.org/licenses/licenses.html">GNU GPL v3</a>. This site is built using the excellent <a href="http://nanoc.stoneship.org/">nanoc</a> tool and example site along with the <a href="http://www.fonts.info/info/press/free-fonts-for-font-face-embedding.htm">Graublau</a> and <a href="http://scripts.sil.org/Gentium">Gentium</a> fonts.</p>
</div>
</body>
</html>
